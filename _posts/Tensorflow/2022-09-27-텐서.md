---
title: "í…ì„œ"
categories: [Tensorflow]
mathjax: true
---

* content
{:toc}
**Tensorflow ê³µì‹ ê°€ì´ë“œ**ì˜ [í…ì„œ ì†Œê°œ(Introduction to Tensors)](https://www.tensorflow.org/guide/tensor)ë¥¼ ì •ë¦¬í•œ ê¸€ì´ë©°, ëª¨ë“  ì´ë¯¸ì§€ì˜ ì¶œì²˜ëŠ” ìœ„ ë§í¬ì—ì„œ ë°œì·Œí•˜ì˜€ë‹¤.

í…ì„œ<sup>Tensor</sup>ëŠ” í…ì„œí”Œë¡œìš°ì™€ ì¼€ë¼ìŠ¤ì—ì„œ ì§€ì›í•˜ëŠ” ë‹¤ì°¨ì› ë°°ì—´ì´ë‹¤.

```python
import tensorflow as tf
import numpy as np
```

í…ì„œ ê°ì²´ì˜ ê¸°ë³¸ì ì¸ íŠ¹ì§•ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

- ëª¨ë“  ìš”ì†ŒëŠ” ê°™ì€ ìë£Œí˜•(Dtype)ì„ ê°€ì§„ë‹¤.

    `tf.dtypes.DType`ì—ì„œ ì§€ì›ë˜ëŠ” ëª¨ë“  ìë£Œí˜•ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

- ìˆ˜ì •í•  ìˆ˜ ì—†ë‹¤(Immutable).

  ê°’ì˜ ë³€ê²½ì´ í•„ìš”í•  ë• ë³€ìˆ˜(`tf.Variable`) ê°ì²´ë¥¼ ëŒ€ì‹  ì‚¬ìš©í•œë‹¤.

- ë„˜íŒŒì´ ì–´ë ˆì´(`np.array`)ì™€ ì¡°ì‘ ë°©ë²•ì´ ìœ ì‚¬í•˜ë‹¤.  

---

# í˜•ìƒ

í…ì„œ ê°ì²´ê°€ ê°€ì§€ê³  ìˆëŠ” í˜•íƒœë¥¼ í˜•ìƒ<sup>Shape</sup>ì´ë¼ í•œë‹¤.

í˜•ìƒì„ ì„¤ëª…í•˜ê¸° ìœ„í•œ ì˜ˆì œë¡œ 4D í…ì„œë¥¼ ìƒì„±í•œë‹¤.

```python
rank_4_tensor = tf.zeros([3, 2, 4, 5])
```

ìƒì„±í•œ 4D í…ì„œë¥¼ ì‹œê°í™”í•˜ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.

![](https://www.tensorflow.org/static/guide/images/tensor/shape.png)![](https://www.tensorflow.org/static/guide/images/tensor/4-axis_block.png)

- í˜•ìƒ<sup>Shape</sup>

  í…ì„œì˜ ê° ì°¨ì›ì˜ ê¸¸ì´ë¥¼ ì˜ë¯¸í•œë‹¤.

  Shape=(3, 2, 4, 5)

- ì°¨ì›<sup>Rank</sup>

  í…ì„œì˜ ì¶•ì˜ ìˆ˜ë¥¼ ì˜ë¯¸í•œë‹¤.

  ì¶•ì´ ì´ 4ê°œ(3, 2, 4, 5)ì´ë¯€ë¡œ Rank=4

  - ì¶•<sup>Axis</sup>

- í…ì„œì˜ íŠ¹ì • ì°¨ì›ì„ ì˜ë¯¸í•œë‹¤.

- axisë¥¼ ì‚¬ìš©í•´ ê° ì¶•ì— ì ‘ê·¼í•  ìˆ˜ ìˆë‹¤.

> *Note*
> í…ì„œë¥¼ êµ¬ì„±í•˜ëŠ” ì¼ë°˜ì ì¸ ì¶• ìˆœì„œëŠ” ë°°ì¹˜ -> ì°¨ì› -> íŠ¹ì„± ìˆœì´ë‹¤.
>
> ![](https://www.tensorflow.org/static/guide/images/tensor/shape2.png)

- í¬ê¸°<sup>Size</sup>

  í…ì„œì˜ ì´ í•­ëª©ì˜ ê³±ì„ ì˜ë¯¸í•œë‹¤.

  Size = 3 x 2 x 4 x 5 = 120

ë‹¤ìŒê³¼ ê°™ì´ í…ì„œ ê°ì²´ì˜ ì†ì„±ì„ í†µí•´ í˜•ìƒ ì •ë³´ì— ì ‘ê·¼í•  ìˆ˜ ìˆë‹¤.

```python
print("Type of every element:", rank_4_tensor.dtype)                            # ìë£Œí˜•
print("Number of dimensions:", rank_4_tensor.ndim)                              # ì°¨ì›
print("Shape of tensor:", rank_4_tensor.shape)                                  # í˜•ìƒ
print("Elements along axis 0 of tensor:", rank_4_tensor.shape[0])               # axis=0ì˜ ìš”ì†Œ ìˆ˜
print("Elements along the last axis of tensor:", rank_4_tensor.shape[-1])       # axis=-1ì˜ ìš”ì†Œ ìˆ˜
print("Total number of elements (3*2*4*5): ", tf.size(rank_4_tensor).numpy())   # í¬ê¸°
```

```
Type of every element: <dtype: 'float32'>
Number of dimensions: 4
Shape of tensor: (3, 2, 4, 5)
Elements along axis 0 of tensor: 3
Elements along the last axis of tensor: 5
Total number of elements (3*2*4*5):  120
```

---

# í…ì„œ ìƒì„±

í…ì„œ ê°ì²´ì˜ í˜•ìƒì€ ì¼ë°˜ì ìœ¼ë¡œ ì§ì‚¬ê°í˜• ëª¨ì–‘ì´ë©°, ì´ë¥¼ **ì •í˜• í…ì„œ**ë¼ í•œë‹¤.

ì •í˜• í…ì„œëŠ” ê° ì¶•ì„ ë”°ë¼ ëª¨ë“  ìš”ì†Œì˜ í¬ê¸°ê°€ ê°™ë‹¤.

ë°˜ë©´ ê·¸ë ‡ì§€ ì•Šì€ í…ì„œë„ ì¡´ì¬í•˜ë©°, ì´ë¥¼ **ë¹„ì •í˜• í…ì„œ**ë¼ í•œë‹¤.

í…ì„œë¥¼ êµ¬ì„±í•˜ëŠ” ìš”ì†Œê°€ ëŒ€ë¶€ë¶„ì´ ë¹„ì–´ ìˆì–´ ë°ì´í„°ê°€ í¬ì†Œí•œ ê²½ìš°ë¥¼ **í¬ì†Œ í…ì„œ**ë¼ í•œë‹¤.

(ë¹„ì •í˜• í…ì„œ ë° í¬ì†Œ í…ì„œëŠ” í›„ìˆ )

ì •í˜• í…ì„œëŠ” `tf.constant()` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ ìƒì„±í•œë‹¤.

- ğŸ’¬ <https://www.tensorflow.org/api_docs/python/tf/constant>

`value`ë¡œ ë‹¨ì¼ ê°’ì„ ì‚¬ìš©í•˜ë©´ 0ì°¨ì› í…ì„œë¥¼ ìƒì„±í•˜ë©°, `dtype` ë§¤ê°œë³€ìˆ˜ë¡œ í…ì„œì˜ ìë£Œí˜•ì„ ì§€ì •í•œë‹¤.

ë§¤ê°œë³€ìˆ˜ë¥¼ ì§ì ‘ ì§€ì •í•˜ì§€ ì•Šìœ¼ë©´ Pythonì˜ ì •ìˆ˜ë¥¼ `tf.int32`ë¡œ, Pythonì˜ ë¶€ë™ ì†Œìˆ˜ì ì„ `tf.float32`ë¡œ ìë™ ë³€í™˜í•œë‹¤.

0ì°¨ì› í…ì„œëŠ” ìŠ¤ì¹¼ë¼<sup>Scalar</sup>ë¼ í•œë‹¤.

```python
# Rank=0 (Scalar)
rank_0_tensor = tf.constant(4)

print(rank_0_tensor)
```

```
tf.Tensor(4, shape=(), dtype=int32)
```

`value`ë¡œ ë¦¬ìŠ¤íŠ¸ë¥¼ ì‚¬ìš©í•˜ë©´ ë” ë†’ì€ ì°¨ì›ì˜ í…ì„œë¥¼ ìƒì„±í•  ìˆ˜ ìˆë‹¤.

1ì°¨ì› í…ì„œëŠ” ë²¡í„°<sup>Vector</sup>, 2ì°¨ì› í…ì„œëŠ” í–‰ë ¬<sup>Matrix</sup>ì´ë¼ í•œë‹¤.

ì´ë¯¸ì§€ ë“±ì˜ ë°ì´í„°ë¥¼ ì €ì¥í•˜ëŠ” í…ì„œëŠ” 3ê°œ ì´ìƒì˜ ì¶•ì„ ê°€ì§€ê¸°ë„ í•œë‹¤.

ì´ëŸ¬í•œ í…ì„œë¥¼ ë‹¤ì°¨ì› í…ì„œë¼ê³  í•˜ë©°, ì£¼ë¡œ nD í…ì„œ(nì€ í…ì„œì˜ ì°¨ì›)ë¡œ í‘œí˜„í•œë‹¤.

| ìŠ¤ì¹¼ë¼                                                       | ë²¡í„°                                                         | í–‰ë ¬                                                         | 3ì°¨ì› ì´ìƒì˜ í…ì„œ                                            |
| ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| ![](https://www.tensorflow.org/static/guide/images/tensor/scalar.png) | ![](https://www.tensorflow.org/static/guide/images/tensor/vector.png) | ![](https://www.tensorflow.org/static/guide/images/tensor/matrix.png) | ![](https://www.tensorflow.org/static/guide/images/tensor/3-axis_numpy.png) |

```python
# Rank=1 (Vector)
rank_1_tensor = tf.constant([2., 3., 4.])

print(rank_1_tensor)
```

```
tf.Tensor([2. 3. 4.], shape=(3,), dtype=float32)
```

```python
# Rank=2 (Matrix)
rank_2_tensor = tf.constant([[1, 2],
                             [3, 4],
                             [5, 6]], dtype=tf.float16)

print(rank_2_tensor)
```

```
tf.Tensor(
[[1. 2.]
 [3. 4.]
 [5. 6.]], shape=(3, 2), dtype=float16)
```

```python
# Rank=3
rank_3_tensor = tf.constant([[[0, 1, 2, 3, 4],
                              [5, 6, 7, 8, 9]],
                             [[10, 11, 12, 13, 14],
                              [15, 16, 17, 18, 19]],
                             [[20, 21, 22, 23, 24],
                              [25, 26, 27, 28, 29]],])

print(rank_3_tensor)
```

```
tf.Tensor(
[[[ 0  1  2  3  4]
  [ 5  6  7  8  9]]

 [[10 11 12 13 14]
  [15 16 17 18 19]]

 [[20 21 22 23 24]
  [25 26 27 28 29]]], shape=(3, 2, 5), dtype=int32)
```

`tf.constant()` ì™¸ì—ë„ ë‹¤ì–‘í•œ ë°©ë²•ìœ¼ë¡œ í…ì„œë¥¼ ìƒì„±í•  ìˆ˜ ìˆë‹¤.

ì˜ˆë¥¼ ë“¤ì–´, `tf.ones()` í•¨ìˆ˜ëŠ” `shape`ì´ ì£¼ì–´ì§€ë©´ ëª¨ë“  ìš”ì†Œê°€ 1ì¸ í…ì„œë¥¼ ë°˜í™˜í•œë‹¤. 

```python
ones_tensor = tf.ones([2, 3])

print(ones_tensor)
```

---

# í…ì„œ ì—°ì‚°

```python
a = tf.constant([[1, 2],
                 [3, 4]])
b = tf.constant([[1, 1],
                 [1, 1]])
```

ë‘ í…ì„œì˜ ëª¨ì–‘ì´ ì‚°ìˆ  ì—°ì‚°ì˜ ì¡°ê±´ì„ ë§Œì¡±í•œë‹¤ë©´, ë‹¤ìŒê³¼ ê°™ì€ ê¸°ë³¸ ì‚°ìˆ ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤.

-   ë§ì…ˆ

    ë‘ í…ì„œì—ì„œ ëŒ€ì‘í•˜ëŠ” ìš”ì†Œì˜ í•©ë“¤ë¡œ êµ¬ì„±ëœ í…ì„œë¥¼ ë°˜í™˜í•œë‹¤.

    `tf.add(a, b)` í•¨ìˆ˜ ë˜ëŠ” `+` ì—°ì‚°ì ì‚¬ìš©

```python
print(tf.add(a, b), '\n')
print(a + b, '\n')
```

```
tf.Tensor(
[[2 3]
 [4 5]], shape=(2, 2), dtype=int32) 

tf.Tensor(
[[2 3]
 [4 5]], shape=(2, 2), dtype=int32) 
```

-   ìŠ¤ì¹¼ë¼ ê³±

    ë‘ í…ì„œì—ì„œ ëŒ€ì‘í•˜ëŠ” ìš”ì†Œì˜ ê³±ë“¤ë¡œ êµ¬ì„±ëœ í…ì„œë¥¼ ë°˜í™˜í•œë‹¤.  

    `tf.multiply(a, b)` í•¨ìˆ˜ ë˜ëŠ” `*` ì—°ì‚°ì ì‚¬ìš©

```python
print(tf.multiply(a, b), '\n')
print(a * b, '\n')
```

-   í–‰ë ¬ê³±

    `tf.matmul(a, b)` í•¨ìˆ˜ ë˜ëŠ” `@` ì—°ì‚°ì ì‚¬ìš©

```python
print(tf.matmul(a, b), "\n")
print(a @ b, "\n")
```

```
tf.Tensor(
[[3 3]
 [7 7]], shape=(2, 2), dtype=int32) 

tf.Tensor(
[[3 3]
 [7 7]], shape=(2, 2), dtype=int32) 
```

ì´ ì™¸ì—ë„ tfê°€ ì œê³µí•˜ëŠ” ë‹¤ì–‘í•œ í•¨ìˆ˜ë¥¼ í…ì„œì— ì ìš©í•  ìˆ˜ ìˆë‹¤.

```python
c = tf.constant([[4.0, 5.0], [10.0, 1.0]])

print(tf.reduce_max(c)) # ê°€ì¥ í° ê°’
print(tf.argmax(c))     # ê°€ì¥ í° ì¸ë±ìŠ¤
print(tf.nn.softmax(c)) # ì†Œí”„íŠ¸ë§¥ìŠ¤ ë³€í™˜
```

```
tf.Tensor(10.0, shape=(), dtype=float32)
tf.Tensor([1 0], shape=(2,), dtype=int64)
tf.Tensor(
[[2.6894143e-01 7.3105860e-01]
 [9.9987662e-01 1.2339458e-04]], shape=(2, 2), dtype=float32)
```

---

# í…ì„œ ì¸ë±ì‹±

íŒŒì´ì¬ ë¦¬ìŠ¤íŠ¸ ë° ë„˜íŒŒì´ ì–´ë ˆì´ì˜ ì¸ë±ì‹± ê·œì¹™ê³¼ ìœ ì‚¬í•˜ë‹¤.

-   ì¸ë±ìŠ¤ëŠ” 0ì—ì„œ ì‹œì‘í•œë‹¤.
-   ì¸ë±ìŠ¤ê°€ ìŒìˆ˜ì¸ ê²½ìš° ëì—ì„œë¶€í„° ê±°ê¾¸ë¡œ ê³„ì‚°í•œë‹¤(-1ë¶€í„° ì‹œì‘).
-   ìŠ¬ë¼ì´ì‹±ì„ ì§€ì›í•œë‹¤(`start:stop` ë° `start:stop:step`).

```python
rank_1_tensor = tf.constant([0, 1, 1, 2, 3, 5, 8, 13, 21, 34])
print(rank_1_tensor.numpy())
```

```
[ 0  1  1  2  3  5  8 13 21 34]
```

ì§ê´€ì ì¸ ì¶œë ¥ í˜•ì‹ì„ ìœ„í•´ `.numpy()` ë©”ì„œë“œë¥¼ ì‚¬ìš©í•´ í…ì„œ ê°ì²´ë¥¼ ë„˜íŒŒì´ ì–´ë ˆì´ë¡œ ë³€í™˜í•œë‹¤.

```python
print("First:", rank_1_tensor[0].numpy())
print("Second:", rank_1_tensor[1].numpy())
print("Last:", rank_1_tensor[-1].numpy())
```

```
First: 0
Second: 1
Last: 34
```

ì¸ë±ìŠ¤ë¡œ ìŠ¤ì¹¼ë¼ë¥¼ ì‚¬ìš©í•˜ë©´ ì¶•ì´ ì œê±°ëœë‹¤.

ì¶•ì„ ìœ ì§€í•˜ë ¤ë©´ ìŠ¬ë¼ì´ìŠ¤(`:`)ë¥¼ ëŒ€ì‹  ì‚¬ìš©í•œë‹¤.

```python
print("Everything:", rank_1_tensor[:].numpy())
print("Before 4:", rank_1_tensor[:4].numpy())
print("From 4 to the end:", rank_1_tensor[4:].numpy())
print("From 2, before 7:", rank_1_tensor[2:7].numpy())
print("Every other item:", rank_1_tensor[::2].numpy())
print("Reversed:", rank_1_tensor[::-1].numpy())
```

```
Everything: [ 0  1  1  2  3  5  8 13 21 34]
Before 4: [0 1 1 2]
From 4 to the end: [ 3  5  8 13 21 34]
From 2, before 7: [1 2 3 5 8]
Every other item: [ 0  1  3  8 21]
Reversed: [34 21 13  8  5  3  2  1  1  0]
```

2ì°¨ì› í…ì„œì˜ ê²½ìš° ë‘ ê°œì˜ ì¸ë±ìŠ¤ë¥¼ ì‚¬ìš©í•´ ì¸ë±ì‹±í•œë‹¤.

```python
print(rank_2_tensor.numpy())
```

```
[[1. 2.]
 [3. 4.]
 [5. 6.]]
```

```python
print(rank_2_tensor[1, 1].numpy())
```

```
4.0
```

```python
print("Second row:", rank_2_tensor[1, :].numpy())
print("Second column:", rank_2_tensor[:, 1].numpy())
print("Last row:", rank_2_tensor[-1, :].numpy())
print("First item in last column:", rank_2_tensor[0, -1].numpy())
print("Skip the first row:")
print(rank_2_tensor[1:, :].numpy())
```

```
Second row: [3. 4.]
Second column: [2. 4. 6.]
Last row: [5. 6.]
First item in last column: 2.0
Skip the first row:
[[3. 4.]
 [5. 6.]] 
```

---

# í˜•ìƒ ì¡°ì‘

í…ì„œ ê°ì²´ëŠ” ì•ì„œ ì–¸ê¸‰í–ˆë“¯ ë¶ˆë³€Immutableì´ë‹¤.

ë”°ë¼ì„œ í˜•ìƒ ì¡°ì‘ì„ ìœ„í•´ì„œëŠ” ë¨¼ì € `tf.Variable()` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ ë³€ìˆ˜ë¡œ ë³€í™˜í•´ì•¼ í•œë‹¤.
