<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sort</title>
    <style>
      body {
        width: 400px;
      }
      
      main {
        position: relative;
        width: 300px;
        height: 300px;
        text-align: center;
        border: 3px solid;
      }

      main::after {
          position: absolute;
          width: 300px;
          height: 300px;
          content: "";
          background-image: url(https://img.lovepik.com/element/40126/1876.png_300.png);
          opacity: 0.5;
          top: 0;
          left: 0;
          z-index: -1;
      }

      .wrap {
          width: 300px;
          height: 300px;
          text-align: center;
      }

      .bar {
          position: absolute;
          background-color: #FFCC33;
          left: 95px;
          bottom: 0;
          margin: 10px 2px;
          height: 35px;
          transition: 1s ease;
          border: 3px solid;
          border-color: #FFCC33;
          text-align: center;
      }

      .message {
          text-align: center;
          font-weight: bold;
          font-size: 25px;
          font-family: "Comic Sans MS";
      }

      nav {
          width: 60px;
      }
      button:hover  {
          border-color: red;
          border-width: 5px;
      }

      #bubble {
          width: 50px;
          height: 50px;
          background-color: #333;
          font-size: 25px;
          border-radius: 3px;
          margin: 5px;
          padding: 3px;
      }

      #retry {
          width: 50px;
          height: 50px;
          background-color: #333;
          color: white;
          font-size: 25px;
          border-radius: 3px;
          margin: 5px;
          padding: 3px;
      }
    </style> 
</head>
<body>
  <main>
    <div class="wrap"></div>
  </main>
  <nav>
    <button id="bubble" onclick="bubble_sort(arr)">üç∫</button>
    <button id="retry" onclick="retry()">Re</button>
  </nav>
</body>
<script>
  function bubble_sort(arr) {
    const n = arr.length;
    let count = 0;
    for (let i=0; i<n-1; i++){
        for (let j=n-1; j>i; j--) {
            count++;
            setTimeout(()=>{
                if (arr[j-1] > arr[j]) {
                    [arr[j-1], arr[j]] = [arr[j], arr[j-1]];
                    exchange(j-1, j);
                }
                else
                    accent(j-1, j);
                console.log(arr);
            }, 2000*count);
        }
    }
  }

  function retry() {
    arr = [90, 56, 34, 12, 78];
    render(arr);
    console.log(arr);
  }

  function render(arr) {
    var wrap = document.querySelector('.wrap');
    wrap.innerHTML = "";
    for(var i=0; i <arr.length; i++) {
        wrap.insertAdjacentHTML('beforeend', `<div class="bar" style="height:35px; width:100px; top:${i*50+20}px;" pos="${i}"></div>`);
    }
    var bar = document.getElementsByClassName("bar");
    for(let i=0; i<arr.length; i++) {
        bar[arr.length - 1 - i].innerHTML = `<div class="message">${arr[arr.length - 1 - i]}</div>`;
    }
  }

  function exchange(i, j) {
    var iDiv = document.querySelector(`.wrap [pos="${i}"]`);   // wrap [pos="i"]
    var jDiv = document.querySelector(`.wrap [pos="${j}"]`);   // wrap [pos="j"]
    var iTop = iDiv.style.top;
    var jTop = jDiv.style.top;
    accent(i, j);
    setTimeout(() => {
        iDiv.style.top = jTop;
        jDiv.style.top = iTop;
        iDiv.setAttribute('pos', j );    // ÏöîÏÜåÏùò ÏÜçÏÑ± Í∞íÏùÑ Ï†ïÌïúÎã§.
        jDiv.setAttribute('pos', i );    // ÏöîÏÜåÏùò ÏÜçÏÑ± Í∞íÏùÑ Ï†ïÌïúÎã§.
    }, 500);

  }

  function accent(i, j) {
    var iDiv = document.querySelector(`.wrap [pos="${i}"]`);   // wrap [pos="i"]
    var jDiv = document.querySelector(`.wrap [pos="${j}"]`);   // wrap [pos="j"]
    iDiv.style.borderColor = "red";
    jDiv.style.borderColor = "red";
    setTimeout(() => {              //#FFF4D4
        iDiv.style.borderColor = "#FFCC33";
        jDiv.style.borderColor = "#FFCC33";
    }, 1000);
  }

  retry()
</script>
</html>