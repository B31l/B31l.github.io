---
layout: post
title: "🎲 (2) 압축 알고리즘"
meta: "Compress & Decompresss"
categories: Classic_Computer_Science_Problems
tags: Python
---
* content
{:toc}

# ?

저장 공간이 제한될 경우 파일을 압축할 필요가 있으며, 이 때 **압축 알고리즘**이 사용된다.

다양한 압축 알고리즘이 존재하지만, 궁극적으로는 다음 기능을 구현해야 한다.

- **압축**(compress)

  부호화(encoding) 과정을 거쳐 원본 파일을 압축 파일로 변환한다.

- **압축 풀기**(decomporess)

  복호화(decoding) 과정을 거쳐 압축 파일을 원본 파일로 변환한다.

---

# **유전 정보 압축**

![nucleotide](https://cdn.pixabay.com/photo/2016/11/09/15/27/dna-1811955_960_720.jpg)

DNA는 4가지 종류(A, C, G, T)의 뉴클레오타이드(nucleotide)로 구성된다. 

만약 ` n`개의 뉴클레오타이드로 구성된 염기서열을 문자열로 작성할 경우, 각 문자의 크기는 8비트이므로 총 `8n`비트의 저장공간이 필요하다. 

| 문자 | 8bit     |
| ---- | -------- |
| A    | 01000001 |
| C    | 01000011 |
| G    | 01000111 |
| T    | 01010100 |

하지만 4가지 종류의 문자를 나타내는 데에는 2개의 비트만 있어도 충분하다. 각 문자의 크기를 2비트로 압축한다면 필요한 저장공간은`2n`비트로 감소한다.

| 문자 | 2bit |
| ---- | ---- |
| A    | 00   |
| C    | 01   |
| G    | 10   |
| T    | 11   |

이 아이디어를 사용해 유전 정보를 1/4로 압축하는 알고리즘을 작성한다.

## 1. compress

```python
def compress(gene:str) -> str:
    bit_string:int = 1
    for nucleotide in gene.upper():
        bit_string <<= 2
        if   nucleotide == "A": bit_string |= 0b00
        elif nucleotide == "C": bit_string |= 0b01
        elif nucleotide == "G": bit_string |= 0b10
        elif nucleotide == "T": bit_string |= 0b11
        else: 
            raise ValueError(f"Invalid nucleotide: { nucleotide }")
    return bit_string
```



## 2. decompress

```python
def decompress(bit_string:str) -> str:
    gene:str = ""
    for i in range(0, bit_string.bit_length() - 1, 2):
        bits:int = bit_string >> i & 0b11
        if   bits == 0b00: gene += "A"
        elif bits == 0b01: gene += "C"
        elif bits == 0b10: gene += "G"
        elif bits == 0b11: gene += "T"
        else: 
            raise ValueError(f"Invalid bits: { bits }")
    return gene[::-1] # Reverse
```

`bit_string`의 끝 부분부터 2개씩 비트 문자열을 읽은 뒤, 뉴클레오타이드로 변환한 값을 `gene`에  추가한다. 

처음 bit_string을 만들 때 비트 1로 시작했기 때문에 해당 비트를 제외해야 하므로, 전체 길이에서 1을 뺀 값만큼 반복을 시행한다.

## 3. 실행

```python
g = "TAGGGATTAACCGTTATATATCCAGATATACGGA"
c = compress(g)
d = decompress(c)
print(g == d)
```



## 4. Dictionary vs If statement

조건문 대신 파이썬의 **사전 자료형**를 사용해 구현할 수도 있다. 이 때 Dictionary는 뉴클레오타이드와 그에 해당하는 비트를  각각 Key와 Value로 갖는다. 

조건문을 사용하면 각 반복 당 최대 4번 비교해야 하며, 사전 자료형을 사용하면 해시 충돌이 발생할 수 있다. 

하지만 결과적으로는 두 방법 모두 `O(n)`의 시간 복잡도를 가진다. (n = 부호화 및 복호화 과정에서의 입력값의 길이)

---

# **허프만 부호화**



## 1. compress

```python

```



## 2. decompress

```python
```



---

# Reference

- <https://clansim.tistory.com/73>

