---
title: "텐서플로우 작업환경 구성"
categories: [DeepLearning]
tags: Python
mathjax: true
---

* content
{:toc}
# 1. WSL 2 & Ubuntu
참고: [이전 버전 WSL의 수동 설치 단계](https://docs.microsoft.com/ko-kr/windows/wsl/install-manual)
## 1.1 기본 프로그램 설치
Microsoft Store에서 **Windows Terminal** 및 **Ubuntu 20.04.4 LTS**를 설치한다.
우분투 설치가 끝나면 실행하여 username 및 password를 설정한다.
## 1.2 WSL 설치
PowerShell을 관리자 권한으로 실행한 뒤, **Linux용 Windows 하위 시스템 사용 옵션** 기능을 사용하도록 설정한다. 
```shell
> dism.exe /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart 
```
## 1.3 WSL 2로 업데이트
실행 창(`Windows 로고 키 + R`)에 **winver**을 입력하거나, 설정에서 **PC 정보**를 검색해 윈도우 버전을 확인해 업데이트 가능 여부를 확인해야 한다. 18362보다 낮은 빌드는 WSL 2를 지원하지 않으므로 주의해야 한다.
PowerShell을 관리자 권한으로 실행한 뒤, **Virtual Machine** 기능을 사용하도록 설정한다.
```shell
> dism.exe /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart
```
## 1.4 WSL 2를 기본 버전으로 설정
WSL2를 기본 버전으로 설정한다.
```shell
> wsl --set-default-version 2
```
위 명령이 작동하지 않으면 <aka.ms/wsl2kernel>에서 최신 WSL2 Linux 커널 업데이트 패키지를 설치한 뒤, 다음 명령을 대신 입력한다.
```shell
> wsl --set-default-version Ubuntu-20.04 2
```
WSL 버전은 다음과 같이 확인할 수 있다.
```shell
> wsl -l -v

  NAME                   STATE           VERSION
* Ubuntu-20.04           Running         2
```
## 1.5 Ubuntu 설정
**Windows Terminal**에서 우분투를 기본 프로필로 설정하거나 모양을 변경할 수 있다.
예쁜 디자인과 자유도 높은 커스터마이징이 정말 마음에 든다!

# 2. Docker & Tensorflow
## 2.1 # Windows에 Docker 데스크톱 설치
참고: [Windows에 Docker 데스크톱 설치](https://docs.docker.com/desktop/windows/install/)

## 2.2 Ubuntu에 Docker 엔진 설치
참고: [Ubuntu에 Docker 엔진 설치](https://docs.docker.com/engine/install/ubuntu/)

``` shell
$ sudo apt-get update
$ sudo apt-get install \
    ca-certificates \
    curl \
    gnupg \
    lsb-release
```

## 2.3 설치 후 단계 (Optional)
참고: [선택적 설치 후 단계](https://docs.docker.com/engine/install/linux-postinstall/)
루트가 아닌 사용자 그룹에 root와 동일한 권한을 부여하면 Docker를 관리할 수 있다.
먼저, docker 그룹을 생성한다.
```shell
$ sudo groupadd docker
```
생성한 docker 그룹에 사용자를 추가한 다음, 재시작한다.
```shell
$ sudo usermod -aG docker $USER
$ newgrp docker 
```
 `sudo` 명령어 없이도 docker 명령을 수행할 수 있는 것을 확인할 수 있다.
```shell
$ docker run hello-world
```

## 2.4 NVIDIA Docker 지원 설치
참고: [NVIDIA Docker 지원을 설치](https://docs.nvidia.com/datacenter/cloud-native/container-toolkit/install-guide.html#docker)
Linux 환경에서 Tensorflow가 GPU를 지원하려면 NVIDIA Docker 지원을 설치해야 한다.

## 2.5 Tensorflow Docker 이미지 다운로드
참고: [Tensorflow Docker 이미지 다운로드](https://www.tensorflow.org/install/docker?hl=ko)

## 2.6 Jupyter Notebook 실행
```shell
docker run --gpus all -lt -v $(realpath ~/notebooks):/tf/notebooks -p 8888:8888 tensorflow/tensorflow:latest-gpu-jupyter
```

## 2.7 도커 명령어
다음 명령은 도커 데몬을 활성화한다.
```shell
$ sudo service docker start
```