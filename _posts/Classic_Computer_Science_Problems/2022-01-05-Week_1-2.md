---
layout: post
title: "ğŸ² (1-2) ì••ì¶• ì•Œê³ ë¦¬ì¦˜"
meta: "Compress & Decompresss"
categories: Classic_Computer_Science_Problems
tags: Python
---
* content
{:toc}

# ?

ì €ì¥ ê³µê°„ì´ ì œí•œë  ê²½ìš° íŒŒì¼ì„ ì••ì¶•í•  í•„ìš”ê°€ ìˆìœ¼ë©°, ì´ ë•Œ **ì••ì¶• ì•Œê³ ë¦¬ì¦˜**ì´ ì‚¬ìš©ëœë‹¤.

ë‹¤ì–‘í•œ ì••ì¶• ì•Œê³ ë¦¬ì¦˜ì´ ì¡´ì¬í•˜ì§€ë§Œ, ê¶ê·¹ì ìœ¼ë¡œëŠ” ë‹¤ìŒ ê¸°ëŠ¥ì„ êµ¬í˜„í•´ì•¼ í•œë‹¤.

- **ì••ì¶•(compress)**

  ë¶€í˜¸í™”(encoding) ê³¼ì •ì„ ê±°ì³ ì›ë³¸ íŒŒì¼ì„ ì••ì¶• íŒŒì¼ë¡œ ë³€í™˜í•œë‹¤.

- **ì••ì¶• í’€ê¸°(decomporess)**

  ë³µí˜¸í™”(decoding) ê³¼ì •ì„ ê±°ì³ ì••ì¶• íŒŒì¼ì„ ì›ë³¸ íŒŒì¼ë¡œ ë³€í™˜í•œë‹¤.

---

# ìœ ì „ ì •ë³´ ì••ì¶•

![](https://github.com/B31l/B31l.github.io/blob/master/img/Classic_Computer_Science_Problems/compress-00.jpg?raw=true)

DNAëŠ” 4ê°€ì§€ ì¢…ë¥˜(A, C, G, T)ì˜ ë‰´í´ë ˆì˜¤íƒ€ì´ë“œ(nucleotide)ë¡œ êµ¬ì„±ëœë‹¤. 

ë§Œì•½ `n`ê°œì˜ ë‰´í´ë ˆì˜¤íƒ€ì´ë“œë¡œ êµ¬ì„±ëœ ì—¼ê¸°ì„œì—´ì„ ë¬¸ìì—´ë¡œ ì‘ì„±í•  ê²½ìš°, ê° ë¬¸ìì˜ í¬ê¸°ëŠ” 8ë¹„íŠ¸ì´ë¯€ë¡œ ì´ `8n`ë¹„íŠ¸ì˜ ì €ì¥ê³µê°„ì´ í•„ìš”í•˜ë‹¤. (UTF-8 ê¸°ì¤€)

| ë¬¸ì | 8bit     |
| ---- | -------- |
| A    | 01000001 |
| C    | 01000011 |
| G    | 01000111 |
| T    | 01010100 |

í•˜ì§€ë§Œ 4ê°€ì§€ ì¢…ë¥˜ì˜ ë¬¸ìë¥¼ ë‚˜íƒ€ë‚´ëŠ” ë°ì—ëŠ” 2ê°œì˜ ë¹„íŠ¸ë§Œ ìˆì–´ë„ ì¶©ë¶„í•˜ë‹¤. 

ê° ë¬¸ìì˜ í¬ê¸°ë¥¼ 2ë¹„íŠ¸ë¡œ ì••ì¶•í•œë‹¤ë©´ í•„ìš”í•œ ì €ì¥ê³µê°„ì€`2n`ë¹„íŠ¸ë¡œ ê°ì†Œí•˜ë©°, ìµœëŒ€ 75%ì˜ ì €ì¥ ê³µê°„ì„ ì ˆì•½í•  ìˆ˜ ìˆë‹¤. 

| ë¬¸ì | 2bit |
| ---- | ---- |
| A    | 00   |
| C    | 01   |
| G    | 10   |
| T    | 11   |

ì´ ì•„ì´ë””ì–´ë¡œ ìœ ì „ ì •ë³´ë¥¼ ì••ì¶•í•˜ëŠ” ì•Œê³ ë¦¬ì¦˜ì„ ì‘ì„±í•œë‹¤.

## 1. compress

ë‰´í´ë ˆì˜¤íƒ€ì´ë“œì˜ ìˆ˜ë§Œí¼ 2ë¹„íŠ¸ ë¬¸ìì—´ì„ ì¶”ê°€í•˜ë©°, ì¶”ê°€í•  ë•Œë§ˆë‹¤ ì‰¬í”„íŠ¸ ì—°ì‚°ì `<<`ë¥¼ ì‚¬ìš©í•´ 2ë¹„íŠ¸ì”© ì™¼ìª½ìœ¼ë¡œ ì´ë™í•œë‹¤.

ì˜ˆë¥¼ ë“¤ì–´ ë¬¸ìì—´ **ATGC**ì„ ì¸ìˆ˜ë¡œ ë„˜ê¸°ë©´, ëŒ€ì‘í•˜ëŠ” 2ë¹„íŠ¸ ë¬¸ìì—´ì„ ì´ˆê¸°ê°’ 1 ë’¤ì— ì°¨ë¡€ëŒ€ë¡œ ì¶”ê°€í•œë‹¤. 

ë¹„íŠ¸ ë‹¨ìœ„ ì—°ì‚°ì—ì„œ ë¹„íŠ¸ ì¶”ê°€ëŠ” `|=` ì—°ì‚°ìë¥¼ ì‚¬ìš©í•œë‹¤.

![](https://github.com/B31l/B31l.github.io/blob/master/img/Classic_Computer_Science_Problems/compress-01.png?raw=true)

ì••ì¶• ê³¼ì •ì„ íŒŒì´ì¬ìœ¼ë¡œ êµ¬í˜„í•˜ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.

```python
def compress(gene:str) -> str:
    bit_string:int = 1
    for nucleotide in gene.upper():
        bit_string <<= 2
        if   nucleotide == "A": bit_string |= 0b00
        elif nucleotide == "C": bit_string |= 0b01
        elif nucleotide == "G": bit_string |= 0b10
        elif nucleotide == "T": bit_string |= 0b11
        else: 
            raise ValueError(f"Invalid nucleotide: { nucleotide }")
    return bit_string
```

```python
from sys import getsizeof

original = "ATGC"
compressed = compress(original)
print(f"{ original }: { getsizeof(original) }ë°”ì´íŠ¸")
print(f"{ bin(compressed) }: { getsizeof(compressed) }ë°”ì´íŠ¸")
```

```
ATGC: 53ë°”ì´íŠ¸
0b100111001: 28ë°”ì´íŠ¸
```

`sys.getsizeof()` ë©”ì„œë“œë¥¼ ì‚¬ìš©í•´ ë°”ì´íŠ¸ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

> íŒŒì´ì¬ ê°ì²´ ì‹œìŠ¤í…œì˜ ë‚´ì œëœ ì˜¤ë²„í—¤ë“œ ë•Œë¬¸ì— ì €ì¥ê³µê°„ì˜ í¬ê¸°ë¥¼ 28ë°”ì´íŠ¸ ë¯¸ë§Œìœ¼ë¡œ ì¤„ì¼ ìˆ˜ëŠ” ì—†ë‹¤.

> bit_stringì˜ ì´ˆê¸°ê°’ì„ 0ìœ¼ë¡œ ì„¤ì •í•´ë„ ê´œì°®ì§€ ì•Šì„ê¹Œ? ë‹¨ìˆœíˆ ì²« ë²ˆì§¸ ìë¦¬ë§Œ 1ì—ì„œ 0ìœ¼ë¡œ ë°”ë€ ê°’ì¸ **000111001**ì„ ë°˜í™˜í•  ê²ƒì´ë¼ê³  ì˜ˆì¸¡í•  ìˆ˜ë„ ìˆë‹¤. í•˜ì§€ë§Œ ë°˜í™˜ë˜ëŠ” ê°’ì€ **111001**ì´ë‹¤. 
>
> ì´ìœ ëŠ” ê°„ë‹¨í•˜ë‹¤. bit_stringì€ ì •ìˆ˜í˜•ì´ê¸° ë•Œë¬¸ì— 0ìœ¼ë¡œ ì‹œì‘í•˜ëŠ” ì• ìë¦¿ìˆ˜ë¥¼ ëª¨ë‘ ì œê±°í•´ ë°˜í™˜í•˜ê¸° ë•Œë¬¸ì´ë‹¤. ë”°ë¼ì„œ ë³€í™˜ ì˜¤ë¥˜ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ì„œ bit_stringì˜ ì´ˆê¸°ê°’ì€ ë°˜ë“œì‹œ 1ë¡œ ì„¤ì •í•´ì•¼ í•œë‹¤. 

## 2. decompress

bit_stringì˜ ë ë¶€ë¶„ë¶€í„° 2ê°œì”© ë¹„íŠ¸ ë¬¸ìì—´ì„ ì½ì€ ë’¤, ë‰´í´ë ˆì˜¤íƒ€ì´ë“œë¡œ ë³€í™˜í•œ ê°’ì„ geneì—  ì¶”ê°€í•œë‹¤. 

ì²˜ìŒ bit_stringì„ ë§Œë“¤ ë•Œ ë¹„íŠ¸ 1ë¡œ ì‹œì‘í–ˆê¸° ë•Œë¬¸ì— í•´ë‹¹ ë¹„íŠ¸ë¥¼ ì œì™¸í•´ì•¼ í•˜ë¯€ë¡œ, ì „ì²´ ê¸¸ì´ì—ì„œ 1ì„ ëº€ ê°’ë§Œí¼ ë°˜ë³µì„ ì‹œí–‰í•œë‹¤.

ë³µí˜¸í™” ê³¼ì •ì—ì„œ ì—­ìˆœìœ¼ë¡œ ì½ì—ˆê¸° ë•Œë¬¸ì— geneì—ëŠ” ë’¤ì§‘íŒ ê°’ì´ ì €ì¥ë˜ì–´ ìˆë‹¤. ë”°ë¼ì„œ `[::1]`ì„ ì‚¬ìš©í•´ ì›ë˜ ê°’ìœ¼ë¡œ ë³€í™˜í•œ ë’¤ ë°˜í™˜í•´ì•¼ í•œë‹¤.

![](https://github.com/B31l/B31l.github.io/blob/master/img/Classic_Computer_Science_Problems/compress-02.png?raw=true)

ì••ì¶• í•´ì œ ê³¼ì •ì„ íŒŒì´ì¬ìœ¼ë¡œ êµ¬í˜„í•˜ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.

```python
def decompress(bit_string:str) -> str:
    gene:str = ""
    for i in range(0, bit_string.bit_length() - 1, 2):
        bits:int = bit_string >> i & 0b11
        if   bits == 0b00: gene += "A"
        elif bits == 0b01: gene += "C"
        elif bits == 0b10: gene += "G"
        elif bits == 0b11: gene += "T"
        else: 
            raise ValueError(f"Invalid bits: { bits }")
    return gene[::-1] # Reverse
```

```python
decompressed = decompress(compressed)
print(f"{ decompressed }: { getsizeof(decompressed) }")
```

```
ATGC: 53
```

ì›ë³¸ ë°ì´í„° `original`ì™€, ì••ì¶• í›„ í•´ì œ ê³¼ì •ì„ ê±°ì¹œ ë°ì´í„° `decompressed`ê°€ ê°™ìŒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

## 3. ì‹œê°„ ë³µì¡ë„ ë¶„ì„

`n`: ë¶€í˜¸í™” ë° ë³µí˜¸í™” ê³¼ì •ì—ì„œì˜ ì…ë ¥ê°’ì˜ ê¸¸ì´

| ë©”ì„œë“œ     | ì‹œê°„ë³µì¡ë„ |
| ---------- | ---------- |
| compress   | O(n)       |
| decompress | O(n)       |

## 4. Dictionary vs If statement

ì¡°ê±´ë¬¸ ëŒ€ì‹  íŒŒì´ì¬ì˜ **ì‚¬ì „ ìë£Œí˜•**ë¥¼ ì‚¬ìš©í•´ êµ¬í˜„í•  ìˆ˜ë„ ìˆë‹¤. ì´ ë•Œ DictionaryëŠ” ë‰´í´ë ˆì˜¤íƒ€ì´ë“œì™€ ê·¸ì— í•´ë‹¹í•˜ëŠ” ë¹„íŠ¸ë¥¼  ê°ê° Keyì™€ Valueë¡œ ê°–ëŠ”ë‹¤. 

ì¡°ê±´ë¬¸ì„ ì‚¬ìš©í•˜ë©´ ê° ë°˜ë³µ ë‹¹ ìµœëŒ€ 4ë²ˆ ë¹„êµí•´ì•¼ í•˜ë©°, ì‚¬ì „ ìë£Œí˜•ì„ ì‚¬ìš©í•˜ë©´ í•´ì‹œ ì¶©ëŒì´ ë°œìƒí•  ìˆ˜ ìˆë‹¤. 

í•˜ì§€ë§Œ ê²°ê³¼ì ìœ¼ë¡œëŠ” ë‘ ë°©ë²• ëª¨ë‘ `O(n)`ì˜ ì‹œê°„ ë³µì¡ë„ë¥¼ ê°€ì§„ë‹¤.

---

# í—ˆí”„ë§Œ ë¶€í˜¸í™”

ìœ ì „ ë°ì´í„°ëŠ” 4ê°€ì§€ ì¢…ë¥˜ì˜ ë¬¸ìë¡œë§Œ êµ¬ì„±ëœ **ê³ ì • ê¸¸ì´ ì½”ë“œ(fixed length code)**ì´ë‹¤. ì••ì¶• ê³¼ì •ì´ ì–´ë µì§€ ì•Šì§€ë§Œ ë¬¸ìì˜ ì¢…ë¥˜ê°€ ë§ì•„ì§ˆìˆ˜ë¡ ì´ ë°©ë²•ì€ í•œê³„ì— ë¶€ë”ªíŒë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ASCII ë¬¸ì„œëŠ” ìµœëŒ€ 128ê°€ì§€ì˜ ë¬¸ìë¡œ êµ¬ì„±ë˜ë©°, ìœ ë‹ˆì½”ë“œì˜ ê²½ìš° í•œê¸€ ìˆ˜ë§Œ í•´ë„ 11,172ê°œì´ë‹¤. ê° ë¬¸ìì— í•´ë‹¹í•˜ëŠ” ë¹„íŠ¸ ë¬¸ìì—´ì„ ì¼ì¼ì´ ì§€ì •í•˜ëŠ” ê²ƒì€ ë¹„íš¨ìœ¨ì ì´ë©° ë†’ì€ ì••ì¶•ë¥ ì„ ê¸°ëŒ€í•  ìˆ˜ ì—†ë‹¤. 

**ê°€ë³€ ê¸¸ì´ ì½”ë“œ(variable length code)**ë¥¼ ì‚¬ìš©í•˜ë©´ ê³ ì • ê¸¸ì´ ì½”ë“œì˜ ë¬¸ì œì ì„ í•´ê²°í•  ìˆ˜ ìˆë‹¤. ëŒ€í‘œì ì¸ ì•Œê³ ë¦¬ì¦˜ì¸ **í—ˆí”„ë§Œ ë¶€í˜¸í™”(Huffman coding)** ê³¼ì •ì—ì„œëŠ” ê° ë¬¸ìì˜ ë“±ì¥ ë¹ˆë„ë¥¼ ë°”íƒ•ìœ¼ë¡œ íŠ¸ë¦¬ë¥¼ ë§Œë“  ë’¤, ë…¸ë“œì˜ ìœ„ì¹˜ì— ë”°ë¼ ì„œë¡œ ë‹¤ë¥¸ ë¹„íŠ¸ ë¬¸ìì—´ì„ ë¶€ì—¬í•œë‹¤. ì´ ë•Œ ë¶€ì—¬ë˜ëŠ” ê°€ë³€ ê¸¸ì´ ì½”ë“œëŠ” ì–´ë–¤ ë¹„íŠ¸ ë¬¸ìì—´ì´ ë‹¤ë¥¸ ë¹„íŠ¸ ë¬¸ìì—´ì˜ ì ‘ë‘ì–´ê°€ ë  ìˆ˜ ì—†ë‹¤ëŠ” ê·œì¹™ì„ ê°–ëŠ” **ì ‘ë‘ì–´ ì½”ë“œ(prefix code)**ì´ë‹¤. 

ì˜ˆë¥¼ ë“¤ì–´ ë¬¸ì Aì™€ Bì— ë‹¤ìŒê³¼ ê°™ì€ ë¹„íŠ¸ ë¬¸ìì—´ì„ ë¶€ì—¬í•œë‹¤. ì´ ë•Œ 11ì€ 110ì˜ ì ‘ë‘ì–´ì´ë¯€ë¡œ ì ‘ë‘ì–´ ì½”ë“œì˜ ì¡°ê±´ì„ ë§Œì¡±í•˜ì§€ ëª»í•œë‹¤. 

```
A: 11
B: 110
```

ì ‘ë‘ì–´ ì½”ë“œë¥¼ ì‚¬ìš©í•˜ë©´ ë³µí˜¸í™” ê³¼ì •ì—ì„œ ë¹ ë¥¸ í•´ì„ì„ í•  ìˆ˜ ìˆë‹¤.

## 1. ê³¼ì •

í—ˆí”„ë§Œ ë¶€í˜¸í™” ê³¼ì •ì„ í†µí•´ ë¬¸ìì—´ **GOOGOLPLEX**ë¥¼ ì••ì¶•í•œë‹¤. 

ìš°ì„  ì£¼ì–´ì§„ ë¬¸ìì—´ì„ ë¬¸ì ë‹¨ìœ„ë¡œ ë¶„í•´í•œ ë‹¤ìŒ, ê° ë¬¸ìê°€ ë“±ì¥í•˜ëŠ” ë¹ˆë„ìˆ˜ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì˜¤ë¦„ì°¨ìˆœìœ¼ë¡œ ì •ë ¬í•œë‹¤.

![](https://github.com/B31l/B31l.github.io/blob/master/img/Classic_Computer_Science_Problems/compress-03.png?raw=true)

ê°€ì¥ ì‘ì€ ë¹ˆë„ìˆ˜ë¥¼ ê°€ì§„ ë‘ ë¬¸ì E, Pë¥¼ ìì‹ ë…¸ë“œë¡œ ê°–ëŠ” ì„œë¸ŒíŠ¸ë¦¬ë¥¼ ë§Œë“ ë‹¤. ì´í›„ ë¹ˆë„ìˆ˜ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë‹¤ì‹œ ì˜¤ë¦„ì°¨ìˆœìœ¼ë¡œ ì •ë ¬í•œë‹¤. íŠ¸ë¦¬ê°€ ì™„ì„±ë  ë•Œê¹Œì§€ ì´ ê³¼ì •ì„ ë°˜ë³µí•œë‹¤.

![](https://github.com/B31l/B31l.github.io/blob/master/img/Classic_Computer_Science_Problems/compress-04.png?raw=true)

![](https://github.com/B31l/B31l.github.io/blob/master/img/Classic_Computer_Science_Problems/compress-05.png?raw=true)

![](https://github.com/B31l/B31l.github.io/blob/master/img/Classic_Computer_Science_Problems/compress-06.png?raw=true)

![](https://github.com/B31l/B31l.github.io/blob/master/img/Classic_Computer_Science_Problems/compress-07.png?raw=true)

![](https://github.com/B31l/B31l.github.io/blob/master/img/Classic_Computer_Science_Problems/compress-08.png?raw=true)

![](https://github.com/B31l/B31l.github.io/blob/master/img/Classic_Computer_Science_Problems/compress-09.png?raw=true)

> ì™„ì„±ëœ í—ˆí”„ë§Œ íŠ¸ë¦¬ì—ì„œ ë°ì´í„° ë…¸ë“œëŠ” í•­ìƒ ë¦¬í”„ì— ìœ„ì¹˜í•œë‹¤. 

íŠ¹ì • ë…¸ë“œì— í•´ë‹¹í•˜ëŠ” ë¹„íŠ¸ ë¬¸ìì—´ì„ êµ¬í•˜ê¸° ìœ„í•´ì„œëŠ” ë£¨íŠ¸ì—ì„œ ë…¸ë“œê¹Œì§€ì˜ ê²½ë¡œë¥¼ ëª¨ë‘ ê³„ì‚°í•´ì•¼ í•œë‹¤. ì´ ë•Œ ë£¨íŠ¸ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì™¼ìª½ ë…¸ë“œëŠ” 0, ì˜¤ë¥¸ìª½ ë…¸ë“œëŠ” 1ì˜ ë¹„íŠ¸ë¥¼ ê°–ëŠ”ë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ë°ì´í„° Eê°€ ìœ„ì¹˜í•œ ë…¸ë“œì˜ ë¹„íŠ¸ ë¬¸ìì—´ì€ ë£¨íŠ¸ì—ì„œ ì¶œë°œí•´ ì˜¤ë¥¸ìª½(`1`) -> ì™¼ìª½(`0`) -> ì˜¤ë¥¸ìª½(`1`) -> ì™¼ìª½(`0`)ì˜ ìˆœì„œë¡œ ì´ë™ í›„ ê°ê°ì˜ ë¹„íŠ¸ë¥¼ ëª¨ë‘ í•©ì¹œ ê°’ì¸ `1010`ì´ë‹¤.

![](https://github.com/B31l/B31l.github.io/blob/master/img/Classic_Computer_Science_Problems/compress-10.png?raw=true)

ë°ì´í„°ì˜ ë¹ˆë„ìˆ˜ê°€ ë†’ì„ìˆ˜ë¡ ì§§ì€ ë¹„íŠ¸ ë¬¸ìì—´ì´ ë¶€ì—¬ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ë˜í•œ ê° ë¹„íŠ¸ ë¬¸ìì—´ì€ ì ‘ë‘ì–´ ì½”ë“œì˜ ì¡°ê±´ì„ ë§Œì¡±í•œë‹¤.

## 2. êµ¬í˜„

```python
from copy import deepcopy
from sys import getsizeof

def find_key(dict, val):
  return next(key for key, value in dict.items() if value == val)

class TreeNode:
    def __init__(self, key, value, left=None, right=None, parent=None):
        self.key = key
        self.value = value
        self.left   = left   if (left   == None) else left.key 
        self.right  = right  if (right  == None) else right.key
        self.parent = parent if (parent == None) else parent.key

    def __repr__(self):
        return f'({self.key}:{self.value} left<{self.left}>-right<{self.right}>-parent<{self.parent}>)\n'

    def set_parent(self, parent):
        self.parent = parent.key

    def get_left(self):
        return self.left

    def get_right(self):
        return self.right

class HuffTree:
    def __init__(self, text:str):
        self.text = text
        self.frequency_map = self.get_frequency_map()
        self.huffTree = self.get_huffTree()
        self.binary_map = self.get_binary_map()
        self.compressed = self.compress()
        self.compressed_bin = bin(self.compressed)
        
    def get_frequency_map(self) -> dict[str:int]:
        frequency_map:dict[str:int] = {}
        for i in self.text:
            if i not in frequency_map:
                frequency_map[i] = 1
            else:
                frequency_map[i] += 1
        return frequency_map
        
    def get_huffTree(self) -> dict[str:TreeNode]:
        frequency_map:dict = self.frequency_map
        x_list:list = list(frequency_map.keys())
        LENGTH = deepcopy(len(frequency_map))
        # -------------------------------------------------- í—ˆí”„ë§Œ íŠ¸ë¦¬ ìƒì„±
        hTree:dict[str:TreeNode] = {}
        for i in range(len(frequency_map)):
            ky = x_list[i]
            vl = frequency_map[ky]
            hTree[ky] = TreeNode(ky, vl)
        # -------------------------------------------------- ê°±ì‹  ë£¨í”„
        for x in range(LENGTH - 1):
            print('-'*40,f'\në£¨í”„ {x}')
            # -------------------------------------------------- 1. ì‘ì—… ëª©ë¡ ì •ë ¬
            print(f'ì •ë ¬ ì „ : {frequency_map}')
            frequency_map = dict(sorted(frequency_map.items(), key=lambda item: item[1])) # ?
            x_list = list(frequency_map.keys())
            print(f'ì •ë ¬ í›„ : {frequency_map}')
            # -------------------------------------------------- 2. ë…¸ë“œ ë³‘í•©
            first, second = x_list[0], x_list[1]
            newNodeKey = f'*{x+1000}'
            newNodeValue = frequency_map[first] + frequency_map[second]
            print(f'ë…¸ë“œ ë³‘í•© : {first} + {second} -> {newNodeKey}')
            # -------------------------------------------------- 3. í—ˆí”„ë§Œ íŠ¸ë¦¬ ê°±ì‹ 
            hTree[newNodeKey] = TreeNode(newNodeKey, newNodeValue, hTree[first], hTree[second])
            hTree[first].set_parent(hTree[newNodeKey])
            hTree[second].set_parent(hTree[newNodeKey])
            print(f'ê°±ì‹ ëœ í—ˆí”„ë§Œ íŠ¸ë¦¬ :\n {hTree}')
            # -------------------------------------------------- 4. ì‘ì—… ëª©ë¡ ê°±ì‹ 
            del frequency_map[first]
            del frequency_map[second]
            frequency_map[newNodeKey] = newNodeValue
        return hTree

    def get_binary_map(self) -> dict[str:int]:
        binary_map:dict[str:int] = {}
        for data in self.frequency_map:
            data_key = deepcopy(data)
            nes = ""
            while True:
                temp = self.huffTree[data].parent
                if temp:
                    if data == self.huffTree[temp].left:
                        nes += "0"
                    else:
                        nes += "1"
                    data = temp
                else:
                    binary_map[data_key] = nes[::-1]
                    break
        return binary_map

    def compress(self) -> int:
        compressed:int = 1
        for char in self.text:
            bit = self.binary_map[char]
            compressed <<= len(bit)
            compressed |= int(bit, 2)
        return compressed

    def decompress(self) -> str:
        decompressed:str = ""
        bit_list = list(self.binary_map.values())
        check_list = self.compressed_bin[3:]
        while len(check_list) >= 1:
            temp = ""
            for i in check_list:
                temp += i
                if temp in bit_list:
                    check_list = check_list[len(temp):]
                    break
                continue
            decompressed += find_key(self.binary_map, temp)
        return decompressed

def find_key(dict, val):
  return next(key for key, value in dict.items() if value == val)
```



## 3. ì‹¤í–‰

```python
if __name__ == "__main__":
    original = "GOOGOLPLEX"
    # original = 'In the beginning God created the heavens and the earth.Now the earth was formless and empty, darkness was over the surface of the deep, and the Spirit of God was hovering over the waters.And God said, "Let there be light," and there was light.God saw that the light was good, and He separated the light from the darkness.God called the light "day," and the darkness he called "night." And there was evening, and there was morning--the first day.'
    machine = HuffTree(original)

    compressed= machine.compress()
    decompressed = machine.decompress()

    print(f'    original: <{ getsizeof(original)     }ë°”ì´íŠ¸> { original     } ')
    print(f'  compressed: <{ getsizeof(compressed)   }ë°”ì´íŠ¸> { compressed   } ')
    print(f'decompressed: <{ getsizeof(decompressed) }ë°”ì´íŠ¸> { decompressed } ')

    print(original == decompressed)
```

```
ë£¨í”„ 0
ì •ë ¬ ì „ : {'G': 2, 'O': 3, 'L': 2, 'P': 1, 'E': 1, 'X': 1}
ì •ë ¬ í›„ : {'P': 1, 'E': 1, 'X': 1, 'G': 2, 'L': 2, 'O': 3}
ë…¸ë“œ ë³‘í•© : P + E -> *1000
ê°±ì‹ ëœ í—ˆí”„ë§Œ íŠ¸ë¦¬ :
 {'G': (G:2 left<None>-right<None>-parent<None>)
, 'O': (O:3 left<None>-right<None>-parent<None>)
, 'L': (L:2 left<None>-right<None>-parent<None>)
, 'P': (P:1 left<None>-right<None>-parent<*1000>)
, 'E': (E:1 left<None>-right<None>-parent<*1000>)
, 'X': (X:1 left<None>-right<None>-parent<None>)
, '*1000': (*1000:2 left<P>-right<E>-parent<None>)        
}
---------------------------------------- 
ë£¨í”„ 1
ì •ë ¬ ì „ : {'X': 1, 'G': 2, 'L': 2, 'O': 3, '*1000': 2}    
ì •ë ¬ í›„ : {'X': 1, 'G': 2, 'L': 2, '*1000': 2, 'O': 3}    
ë…¸ë“œ ë³‘í•© : X + G -> *1001
ê°±ì‹ ëœ í—ˆí”„ë§Œ íŠ¸ë¦¬ :
 {'G': (G:2 left<None>-right<None>-parent<*1001>)
, 'O': (O:3 left<None>-right<None>-parent<None>)
, 'L': (L:2 left<None>-right<None>-parent<None>)
, 'P': (P:1 left<None>-right<None>-parent<*1000>)
, 'E': (E:1 left<None>-right<None>-parent<*1000>)
, 'X': (X:1 left<None>-right<None>-parent<*1001>)
, '*1000': (*1000:2 left<P>-right<E>-parent<None>)        
, '*1001': (*1001:3 left<X>-right<G>-parent<None>)        
}
----------------------------------------
ë£¨í”„ 2
ì •ë ¬ ì „ : {'L': 2, '*1000': 2, 'O': 3, '*1001': 3}
ì •ë ¬ í›„ : {'L': 2, '*1000': 2, 'O': 3, '*1001': 3}
ë…¸ë“œ ë³‘í•© : L + *1000 -> *1002
ê°±ì‹ ëœ í—ˆí”„ë§Œ íŠ¸ë¦¬ :
 {'G': (G:2 left<None>-right<None>-parent<*1001>)
, 'O': (O:3 left<None>-right<None>-parent<None>)
, 'L': (L:2 left<None>-right<None>-parent<*1002>)
, 'P': (P:1 left<None>-right<None>-parent<*1000>)
, 'E': (E:1 left<None>-right<None>-parent<*1000>)
, 'X': (X:1 left<None>-right<None>-parent<*1001>)
, '*1000': (*1000:2 left<P>-right<E>-parent<*1002>)
, '*1001': (*1001:3 left<X>-right<G>-parent<None>)
, '*1002': (*1002:4 left<L>-right<*1000>-parent<None>)      
}
----------------------------------------
ë£¨í”„ 3
ì •ë ¬ ì „ : {'O': 3, '*1001': 3, '*1002': 4}
ì •ë ¬ í›„ : {'O': 3, '*1001': 3, '*1002': 4}
ë…¸ë“œ ë³‘í•© : O + *1001 -> *1003
ê°±ì‹ ëœ í—ˆí”„ë§Œ íŠ¸ë¦¬ :
 {'G': (G:2 left<None>-right<None>-parent<*1001>)
, 'O': (O:3 left<None>-right<None>-parent<*1003>)
, 'L': (L:2 left<None>-right<None>-parent<*1002>)
, 'P': (P:1 left<None>-right<None>-parent<*1000>)
, 'E': (E:1 left<None>-right<None>-parent<*1000>)
, 'X': (X:1 left<None>-right<None>-parent<*1001>)
, '*1000': (*1000:2 left<P>-right<E>-parent<*1002>)
, '*1001': (*1001:3 left<X>-right<G>-parent<*1003>)
, '*1002': (*1002:4 left<L>-right<*1000>-parent<None>)      
, '*1003': (*1003:6 left<O>-right<*1001>-parent<None>)      
}
----------------------------------------
ë£¨í”„ 4
ì •ë ¬ ì „ : {'*1002': 4, '*1003': 6}
ì •ë ¬ í›„ : {'*1002': 4, '*1003': 6}
ë…¸ë“œ ë³‘í•© : *1002 + *1003 -> *1004
ê°±ì‹ ëœ í—ˆí”„ë§Œ íŠ¸ë¦¬ :
 {'G': (G:2 left<None>-right<None>-parent<*1001>)
, 'O': (O:3 left<None>-right<None>-parent<*1003>)
, 'L': (L:2 left<None>-right<None>-parent<*1002>)
, 'P': (P:1 left<None>-right<None>-parent<*1000>)
, 'E': (E:1 left<None>-right<None>-parent<*1000>)
, 'X': (X:1 left<None>-right<None>-parent<*1001>)
, '*1000': (*1000:2 left<P>-right<E>-parent<*1002>)
, '*1001': (*1001:3 left<X>-right<G>-parent<*1003>)
, '*1002': (*1002:4 left<L>-right<*1000>-parent<*1004>)     
, '*1003': (*1003:6 left<O>-right<*1001>-parent<*1004>)     
, '*1004': (*1004:10 left<*1002>-right<*1003>-parent<None>) 
}
```

```
    original: <59ë°”ì´íŠ¸> GOOGOLPLEX
  compressed: <28ë°”ì´íŠ¸> 65782302
decompressed: <59ë°”ì´íŠ¸> GOOGOLPLEX
True
```

í—ˆí”„ë§Œ íŠ¸ë¦¬ë¥¼ ë§Œë“œëŠ” ê³¼ì •ì„ ì¶œë ¥í•œë‹¤. ì´í›„ ì›ë³¸ ë°ì´í„°ë¥¼ ì••ì¶•í•˜ê³  í•´ì œí•˜ê¸°ê¹Œì§€ì˜ ê°ê°ì˜ ê³¼ì •ì˜ ë°”ì´íŠ¸ë¥¼ í‘œì‹œí•˜ê³  ì›ë³¸ê³¼ ê²°ê³¼ë¬¼ì´ ê°™ìŒì„ ì¦ëª…í•œë‹¤.

---

# Reference

- ê³ ì „ ì»´í“¨í„° ì•Œê³ ë¦¬ì¦˜ ì¸ íŒŒì´ì¬

  <img src="https://image.aladin.co.kr/product/21766/43/cover500/k382636009_1.jpg" style="zoom:50%;" />

- <https://clansim.tistory.com/73>

- <https://velog.io/@junhok82/%ED%97%88%ED%94%84%EB%A7%8C-%EC%BD%94%EB%94%A9Huffman-coding>

- <https://isss.tistory.com/771>

