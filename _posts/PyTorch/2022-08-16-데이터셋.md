---
title: "ë°ì´í„°ì…‹"
categories: [PyTorch]
tags: Python
mathjax: true
---

* content
{:toc}
# ë°ì´í„°ì…‹(Dataset)

ëª¨ë¸ í›ˆë ¨ì— ì‚¬ìš©ë˜ëŠ” ìƒ˜í”Œê³¼ ë ˆì´ë¸”ì„ ë¬¶ëŠ” ì»¨í…Œì´ë„ˆë¥¼ **ë°ì´í„°ì…‹**(Dataset)ì´ë¼ í•œë‹¤.

## ë°ì´í„°ì…‹ ë¶ˆëŸ¬ì˜¤ê¸°

ğŸ§¶`torchvision.datasets` ëª¨ë“ˆì€ ì¸ê³µì§€ëŠ¥ í•™ìŠµì„ ìœ„í•œ ë‹¤ì–‘í•œ ë°ì´í„°ì…‹ì„ ì œê³µí•œë‹¤.

ì˜ˆë¥¼ ë“¤ì–´, ìœ ëª…í•œ ë°ì´í„°ì…‹ ì¤‘ í•˜ë‚˜ì¸ **FashionMNIST** ë°ì´í„°ì…‹ì€ ë‹¤ìŒê³¼ ê°™ì´ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆë‹¤.

```python
from torchvision import datasets
from torchvision.transforms import ToTensor, Lambda

training_data = datasets.FashionMNIST(
    root="data",
    train=True,
    download=True,
    transform=ToTensor()
    target_transform=Lambda(lambda y: torch.zeros(10, dtype=torch.float).scatter_(0, torch.tensor(y), value=1))
)
```

FashionMNIST ë°ì´í„°ì…‹ í´ë˜ìŠ¤ì˜ ë§¤ê°œë³€ìˆ˜ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤. ë‹¤ë¥¸ ë°ì´í„°ì…‹ì˜ ë§¤ê°œë³€ìˆ˜ëŠ” [ğŸ“Œì´ê³³](https://pytorch.org/vision/stable/datasets.html)ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

-   `root`(í•„ìˆ˜)

    ë°ì´í„°ì…‹ ì €ì¥ ê²½ë¡œë¥¼ ì§€ì •í•œë‹¤.

-   `train`

    í›ˆë ¨ì…‹ìœ¼ë¡œ ì‚¬ìš©í•  ê²½ìš° Trueë¡œ ì§€ì •í•œë‹¤. í…ŒìŠ¤íŠ¸ì…‹ìœ¼ë¡œ ì‚¬ìš©í•  ê²½ìš° Falseë¡œ ì§€ì •í•œë‹¤.

-   `download`

    ë°ì´í„°ì…‹ì˜ ë‹¤ìš´ ì—¬ë¶€ë¥¼ ì§€ì •í•œë‹¤.

    Trueë¡œ ì§€ì •í•  ê²½ìš°, rootì— ë°ì´í„°ì…‹ì´ ì—†ì„ ë•Œ ì¸í„°ë„·ì—ì„œ ë‹¤ìš´ë¡œë“œí•œë‹¤.

-   `transform`

    ë°ì´í„°ì…‹ì˜ **íŠ¹ì§•**(Feature)ì— ì ìš©í•  **ë³€í˜•**ì„ ì§€ì •í•œë‹¤.

    ğŸ§¶`torchvision.transforms` ëª¨ë“ˆì€ ì—¬ëŸ¬ ë³€í˜• í•¨ìˆ˜ë¥¼ ì œê³µí•œë‹¤.

    ğŸ§¶`torchvision.transforms.ToTensor()` í•¨ìˆ˜ëŠ” **PIL ì´ë¯¸ì§€**ë¥¼ `FloatTensor`ë¡œ ë³€í™˜í•œë‹¤.

-   `target_transform`

    ë°ì´í„°ì…‹ì˜ **ë ˆì´ë¸”**(Label)ì— ì ìš©í•  ë³€í˜•ì„ ì§€ì •í•œë‹¤.

    ğŸ§¶`torchvision.transforms.Lambda()` í•¨ìˆ˜ëŠ” ì‚¬ìš©ì ì •ì˜ ëŒë‹¤ í•¨ìˆ˜ë¥¼ ì ìš©í•œë‹¤.

    ë³€í˜• ì „ yëŠ” 0ë¶€í„° 9ê¹Œì§€ì˜ ê°’ ì¤‘ í•˜ë‚˜ì´ë©°, ë‹¤ìŒ ëŒë‹¤ì‹ì„ ì ìš©í•´ yë²ˆì§¸ ì¸ë±ìŠ¤ì˜ ê°’ì´ 1ì´ê³  ë‹¤ë¥¸ ì¸ë±ìŠ¤ì˜ ê°’ì´ 0ì¸ í¬ê¸° 10ì˜ 1ì°¨ì› í…ì„œë¡œ ì›-í•« ì¸ì½”ë”©í•  ìˆ˜ ìˆë‹¤.

    ```python
    Lambda(lambda y: torch.zeros(10, dtype=torch.float).scatter_(0, torch.tensor(y), value=1))
    ```

## ì‚¬ìš©ì ì •ì˜ ë°ì´í„°ì…‹

ğŸ§¶`torch.utils.data.Dataset`ë¥¼ ìƒì†ë°›ëŠ” í´ë˜ìŠ¤ë¥¼ ìƒì„±í•´ ì‚¬ìš©ì ì •ì˜ ë°ì´í„°ì…‹ì„ êµ¬ì„±í•  ìˆ˜ ìˆë‹¤.

ì‚¬ìš©ì ì •ì˜ ë°ì´í„°ì…‹ í´ë˜ìŠ¤ëŠ” ë°˜ë“œì‹œ `__init_`, `__len__`, `__getitem__` ë©”ì„œë“œë¥¼ êµ¬í˜„í•´ì•¼ í•œë‹¤.

```python
from torch.utils.data import Dataset

class JointDataset(Dataset):
    def __init__(self, x, y):
        self.x = x
        self.y = y
    
    def __len__(self):
        return len(self.x)

    def __getitem__(self, idx):
        return self.x[idx], self.y[idx]
```

ì‚¬ìš©ì ì •ì˜ ë°ì´í„°ì…‹ ê°ì²´ë¥¼ ìƒì„±í•˜ê³ , ì‘ë™ì„ í™•ì¸í•œë‹¤.

```python
torch.manual_seed(1)

t_x = torch.rand([4, 3], dtype=torch.float32)
t_y = torch.arange(4)

joint_dataset = JointDataset(t_x, t_y)

print("length:", len(joint_dataset))
for example in joint_dataset:
    print(f"x: {example[0]}, y: {example[1]}")
```

<u>ì‹¤í–‰ ê²°ê³¼</u>

```
length: 4
x: tensor([0.7576, 0.2793, 0.4031]), y: 0
x: tensor([0.7347, 0.0293, 0.7999]), y: 1
x: tensor([0.3971, 0.7544, 0.5695]), y: 2
x: tensor([0.4388, 0.6387, 0.5247]), y: 3
```

## ë°ì´í„°ë¡œë”(DataLoader)

ëª¨ë¸ í›ˆë ¨ ì‹œ ê° **ì—í¬í¬**(Epoch)ë§ˆë‹¤ ë°ì´í„°ì…‹ ì „ì²´ë¥¼ ìˆœíšŒí•˜ë©°, ê° **ìˆœíšŒ**(Iteration)ë§ˆë‹¤ ë°°ì¹˜ ì‚¬ì´ì¦ˆë§Œí¼ì˜ ìƒ˜í”Œê³¼ ë ˆì´ë¸”ì„ ì‚¬ìš©í•œë‹¤.

ì´ ê³¼ì •ì—ì„œ ìˆœíšŒí•  ë°ì´í„°ì…‹ì˜ ë°°ì¹˜ ì‚¬ì´ì¦ˆë¥¼ ì§ì ‘ ì§€ì •í•˜ê±°ë‚˜, ê° ì—í¬í¬ê°€ ëë‚  ë•Œë§ˆë‹¤ ë°ì´í„°ì…‹ì„ ì„ëŠ” ë“±ì˜ ê¸°ëŠ¥ì´ í•„ìš”í•  ìˆ˜ ìˆë‹¤.

**ë°ì´í„°ë¡œë”**(DataLoader)ë¥¼ ì‚¬ìš©í•˜ë©´ ì´ëŸ¬í•œ ë³µì¡í•œ ê³¼ì •ë“¤ì„ ì¶”ìƒí™”í•  ìˆ˜ ìˆë‹¤.

ğŸ§¶`torch.utils.data.DataLoader` í´ë˜ìŠ¤ì˜ ë§¤ê°œë³€ìˆ˜ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤. ì „ì²´ ë§¤ê°œë³€ìˆ˜ëŠ” [ğŸ“Œì´ê³³](https://pytorch.org/docs/stable/data.html)ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

-   `dataset`(í•„ìˆ˜)

-   `batch_size`=1

    **ë°°ì¹˜ ì‚¬ì´ì¦ˆ**ë¥¼ ì§€ì •í•œë‹¤. ë§Œì•½ í¬ê¸° 10ì˜ ë°ì´í„°ì…‹ì—ì„œ batch_sizeë¥¼ 1ë¡œ ì§€ì •í•˜ë©´ ì´ 10/1 = 10ë²ˆì˜ ìˆœíšŒê°€ ì´ë£¨ì–´ì§„ë‹¤.

- `shuffle`=False

    ê³¼ì í•© ë°©ì§€ë¥¼ ìœ„í•´ ê° ì—í¬í¬ê°€ ëë‚  ë•Œë§ˆë‹¤ ë°ì´í„°ì…‹ì„ **ì„ì–´ì„œ ì‚¬ìš©**í• ì§€ ê²°ì •í•œë‹¤.

- `drop_last`=False

    ë§ˆì§€ë§‰ ë°°ì¹˜ì˜ í¬ê¸°ê°€ ë°°ì¹˜ ì‚¬ì´ì¦ˆë³´ë‹¤ ì‘ì€(ë‚˜ëˆ„ì–´ë–¨ì–´ì§€ì§€ ì•ŠëŠ”) ê²½ìš°, ë§ˆì§€ë§‰ ë°°ì¹˜ë¥¼ dropí• ì§€ ê²°ì •í•œë‹¤.

ë°ì´í„°ë¡œë”ë¥¼ ì‚¬ìš©í•´ ìœ„ì—ì„œ ìƒì„±í•œ ì‚¬ìš©ì ì •ì˜ ë°ì´í„°ì…‹ ê°ì²´ë¥¼ ìˆœíšŒí•˜ê³ , ì‘ë™ì„ í™•ì¸í•œë‹¤.

```python
torch.manual_seed(1)

data_loader = DataLoader(dataset=joint_dataset, batch_size=2, shuffle=True)

for epoch in range(2):
    print(f"epoch {epoch+1}")
    for i, batch in enumerate(data_loader, 1):
        print(f"    batch {i}:\n        x: {batch[0]}\n        y: {batch[1]}")
```

<u>ì‹¤í–‰ ê²°ê³¼</u>

```
epoch 1
    batch 1:
        x: tensor([[0.3971, 0.7544, 0.5695],
        [0.7576, 0.2793, 0.4031]])
        y: tensor([2, 0])
    batch 2:
        x: tensor([[0.4388, 0.6387, 0.5247],
        [0.7347, 0.0293, 0.7999]])
        y: tensor([3, 1])
epoch 2
    batch 1:
        x: tensor([[0.3971, 0.7544, 0.5695],
        [0.7347, 0.0293, 0.7999]])
        y: tensor([2, 1])
    batch 2:
        x: tensor([[0.7576, 0.2793, 0.4031],
        [0.4388, 0.6387, 0.5247]])
        y: tensor([0, 3])
```

---

# ğŸ“ŒREF

-   **Machine Learning with PyTorch and Scikit-Learn**
-   <https://tutorials.pytorch.kr/beginner/basics/data_tutorial.html>
-   <https://tutorials.pytorch.kr/beginner/basics/transforms_tutorial.html>

 
